
@using DicomApp.CommonDefinitions.DTO;
@using DicomApp.CommonDefinitions.DTO;
@using DicomApp.CommonDefinitions.DTO.ShipmentDTOs;
@using DicomApp.Helpers;
@model List<ShipDTO>

<main>
    <div class="container-fluid site-width">
        <!-- START: Filter-->
        <div class="row Red-Row">
            <div class="col-12 col-lg-12 col-xl-12 col-sm-12">
                <div class="sub-header mb-2">
                    <div>
                        <span class="Header-Titel">Problem Report</span>
                    </div>
                </div>
                <div class="Box-Info">
                    <div class="col-md-4 mr-3" style="width:100% !important;">
                        <span class="Yellow-info-Bg"><img src="~/dist/images/Icons/Issues.png"></span>
                        <p>Total Issues</p>
                        <b>@(Model.Where(p => p.ProblemDTOs.Where(r => r.IsReportToVendor).Count() > 0) != null ? Model.Count(s => s.ProblemDTOs.Where(p => p.IsReportToVendor).Any()) : 0)</b>
                        <img class="Img-Tag-info" style="bottom:115px; left:300px" src="~/dist/images/Tag.png">
                    </div>
                    <div class="col-md-4 mr-3" style="width:100% !important;">
                        <span class="Yellow-info-Bg"><img src="~/dist/images/Icons/Pending.png"></span>
                        <p>Pending Issues</p>
                        <b>@(Model.Where(p => p.ProblemDTOs.Where(r => !r.IsDeleted && !r.IsSolved && r.IsReportToVendor).Count() > 0) != null ? Model.Count(s => s.ProblemDTOs.Where(p => !p.IsDeleted && !p.IsSolved && p.IsReportToVendor).Any()) : 0)</b>
                        <img class="Img-Tag-info" style="bottom:115px; left:300px" src="~/dist/images/Tag.png">
                    </div>
                    <div class="col-md-4 mr-5" style="width:100% !important;">
                        <span class="Yellow-info-Bg"><img src="~/dist/images/Icons/Solved.png"></span>
                        <p>Solved Issues</p>
                        <b>@(Model.Where(p => p.ProblemDTOs.Where(r => (r.IsDeleted || r.IsSolved) && r.IsReportToVendor).Count() > 0) != null ? Model.Count(s => s.ProblemDTOs.Where(p => (p.IsDeleted || p.IsSolved) && p.IsReportToVendor).Any()) : 0)</b>
                        <img class="Img-Tag-info" style="bottom:115px; left:300px" src="~/dist/images/Tag.png">

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- END: Filter-->
    <div class="Shipment-container">
        <!-- Start: Filter-->
        <div class="row Red-Row">
            @{
                await Html.RenderPartialAsync("_ToolsRow", new OptionDTO
                {
                    Action = "ProblemReport",
                    Controller = "Vendor",
                    SelectListType = new byte[] { 0 }
                });
            }
        </div>
        <!-- END  : Filter-->
    </div>
    <div class="col-12">
        <span id="Ajaxloader" class="Ajaxloader d-none"></span>
    </div>
    <div class="Table-container">
        <table class="table" id="Red-Table">
            <thead>
                <tr>
                    <td class="text-center">Code</td>
                    <td class="text-center Sort-Column">Date</td>
                    <td class="text-center">Customer</td>
                    <td class="text-center">service</td>
                    <td class="text-center">COD</td>
                    <td class="text-center">Call History</td>
                    <td class="text-center">Status</td>
                    <td class="text-center">Problem</td>
                    <td class="text-center">Reply</td>
                </tr>
            </thead>
            <tbody>
                <partial name="/Views/Vendor/Reports/Problem/_ProblemReportTable.cshtml" model="Model" />
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="10">
                        @{
                            await Html.RenderPartialAsync("_Pagination", 
                            new OptionDTO {
                                Action = "ProblemReport",
                                Controller = "Vendor",
                Count = Model.Where(s => s.ProblemDTOs.Where(p => !p.IsDeleted && !p.IsSolved && p.IsReportToVendor).Any()).Count()
                        });
                        }
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
    <!-- START: Card Data-->
</main>